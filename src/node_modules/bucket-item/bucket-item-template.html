<a ui-sref="layout.round.buckets.details({ groupId: group.id, bucketId: bucket.id })">
  <div class="bucket item" ng-class="{ selected: selected }">

    <p class="name">{{ bucket.name }}</p>

    <div class="contribution-row">
      <div class="progress-column">
        <div class="progress">
          <div class="group progress-bar"
              role="progressbar"
              aria-valuenow="{{bucket.percentageFunded.gt(0) ? bucket.groupContributionPercentage.toString() : ''}}"
              aria-valuemin="0"
              aria-valuemax="100"
              style="width: {{ bucket.groupContributionPercentage.times(100).toString() }}% ;">
            <span class="sr-only">{{ bucket.groupContributionPercentage.toString() }}% Complete</span>
          </div>

          <div cb-round-status
              class="my progress-bar"
              role="progressbar"
              aria-valuenow="{{bucket.percentageFunded.gt(0) ? bucket.myContributionPercentage.toString() : ''}}"
              aria-valuemin="0"
              aria-valuemax="100"
              style="width: {{ model.myContributionPercentageMaxed }}%;">
            <span class="sr-only">{{ model.myContributionPercentageMaxed }}% Complete</span>
          </div>
        </div>

        <div>
          <div class="equation">
            <span class="groupContribution">${{ bucket.groupContribution.toFormat() }}</span>
            <span class="groupPlusMy">+</span>
            <span cb-round-status class="myContribution">${{ bucket.myContribution.amount.toFormat() }}</span>
            <span class="equalsTotal">=</span>
            <span class="amountFunded">${{ bucket.groupContribution.plus(bucket.myContribution.amount).toFormat() }}</span>
          </div>
          <span class="target" ng-if="bucket.target.gt(0)">${{ bucket.target.toFormat() }}</span>
        </div>
      </div>

      <div class="contribution" ng-class="{ contributing: model.contributing, ready: model.inputStatus == 'ready', unsaved: model.inputStatus == 'unsaved', saving: model.inputStatus == 'saving', saved: model.inputStatus == 'saved'}" cb-round-status>

        <span ng-if="model.inputStatus == 'done'" class="btn">Fund</span>

        <span ng-if="model.inputStatus == 'ready' && round.myAllocationLeft.gt(0)" ng-click="model.startContributing($event)" class="btn">Fund</span>
        <span ng-if="model.inputStatus == 'ready' && round.myAllocationLeft.eq(0)" class="btn" tooltip="You have no money left to contribute.">Fund</span>

        <div ng-if="model.inputStatus == 'unsaved'" class="amount-group">
          <span class="currency">$</span>
          <input type="number" min="0" max="{{ round.myAllocationLeft.gt(0) ? (round.myAllocationAmount ? myAllocationAmount : '') : model.myContributionAmount }}" ng-model='model.myContributionAmount' placeholder="0" ng-blur='model.saveContribution(bucket.myContribution)' ng-readonly="round.status.name !== 'open'" class="amount" ng-keydown="model.handleKeyDown($event)">
          <div class="long info">Press enter to save</div>
        </div>

        <div ng-if="model.inputStatus == 'saving'" class="amount-group">
          <span class="currency">$</span>
          <input type="number" ng-model='model.myContributionAmount' readonly="readonly" class="amount">
          <div class="info">Saving...</div>
        </div>

        <div ng-if="model.inputStatus == 'saved'" class="amount-group">
          <span class="currency">$</span>
          <span class="amount" ng-click="(round.status.name === 'open') ? model.startContributing($event) : null">
            {{ model.myContributionAmount }}
          </span>
        </div>
      </div>
    </div>
  </div>
</a>
